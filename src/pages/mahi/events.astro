---
import { Image } from 'astro:assets';
import partnerDUCTF from '@assets/community-partners/ductf.svg';
import partnerKiwibots from '@assets/community-partners/kiwibots.png';
import partnerMOI from '@assets/community-partners/ministryofinspiration.png';
import robocupImage from '@assets/robocup-2025.jpg';
import Card from '@components/ui/Card.astro';
import HeroSection from '@components/ui/HeroSection.astro';
import Layout from '@layouts/Layout.astro';
import type { ImageMetadata } from 'astro';
import { Icon } from 'astro-icon/components';

// Types
type UpcomingEvent = {
	title: string;
	description: string;
	icon: string;
	frequency: string;
	duration: string;
};

type UpcomingItem = {
	title: string;
	description: string;
	link: string;
	logo?: ImageMetadata;
	date?: string;
	location?: string;
};

type Collab = {
	logo?: ImageMetadata;
	partnerName: string;
	eventName: string;
	description: string;
};

// Data
const upcomingEvents: UpcomingEvent[] = [
	{
		title: 'Game Jams',
		description: 'Weekend team game-building sprints and showcases.',
		icon: 'heroicons:puzzle-piece',
		frequency: 'Quarterly',
		duration: '~48h',
	},
	{
		title: 'Robotics Competitions',
		description: 'Design, build, and program robots to complete challenges.',
		icon: 'heroicons:cpu-chip',
		frequency: 'Seasonal',
		duration: '1–2 days',
	},
	{
		title: 'Hackathons',
		description: 'Collaborative coding to solve real-world problems.',
		icon: 'heroicons:code-bracket',
		frequency: 'Twice yearly',
		duration: '24–48h',
	},
];

const collabs: Collab[] = [
	{
		logo: partnerDUCTF,
		partnerName: 'DownUnderCTF',
		eventName: 'DownUnderCTF for Aotearoa',
		description:
			'National cybersecurity competition connecting rangatahi with real-world security challenges',
	},
	{
		logo: partnerKiwibots,
		partnerName: 'Kiwibots',
		eventName: 'VEX Robotics Competitions',
		description: 'Competitive robotics tournaments where teams design, build, and program robots',
	},
	{
		logo: partnerMOI,
		partnerName: 'Ministry of Inspiration',
		eventName: 'RoboCup Junior',
		description:
			'International robotics challenge fostering STEM education through competitive robotics',
	},
	{
		logo: partnerMOI,
		partnerName: 'Ministry of Inspiration',
		eventName: 'Aquabots Challenge',
		description:
			'Underwater robotics competition combining engineering with environmental awareness',
	},
	{
		partnerName: 'NZ Games Festival',
		eventName: 'Student Game Jam',
		description:
			'Collaborative game creation events where rangatahi build games in teams over weekends',
	},
	{
		partnerName: 'Genesia Girls',
		eventName: 'All Girls Hackathon',
		description:
			'Empowering female rangatahi through collaborative coding and problem-solving challenges',
	},
];

// Helper to decide external vs internal links for accessibility/SEO
const isExternal = (url: string) => /^https?:\/\//.test(url);

// Upcoming events list (leave empty if none to show a helpful message)
const upcomingList: UpcomingItem[] = [
	// Example:
	// {
	//   title: "Wellington Game Jam",
	//   description: "48-hour team game jam for rangatahi across the region.",
	//   link: "https://nzgamesfest.com/student-jam",
	//   logo: partnerDUCTF,
	//   date: "Oct 18–19, 2025",
	//   location: "Te Whanganui-a-Tara / Wellington",
	// },
];
---

<Layout
	title="Events"
	description="Competitions, hackathons, and partner-led events for rangatahi across the region."
>
	<HeroSection
		title="Tech Events & <span class='gradient-text'>Competitions</span>"
		description="Showcase skills, connect with peers, and take on real-world challenges."
		image={robocupImage}
		imageAlt="RoboCup competition with student participants"
		backgroundClass="bg-white"
		ctaText="Upcoming Events"
		ctaHref="#upcoming"
	/>

	<!-- Upcoming Events -->
	<section id="upcoming" class="scroll-mt-24 bg-tuhura-gray py-16">
		<div class="container-custom">
			<div class="mx-auto mb-10 max-w-3xl text-center">
				<h2 class="mb-3 text-3xl font-bold md:text-4xl">Upcoming Events</h2>
				<p class="text-lg leading-relaxed text-gray-600">
					Join an event near you. All events are free for our session participants.
				</p>
			</div>

			{
				upcomingList.length === 0 ? (
					<div class="mx-auto max-w-3xl rounded-xl border border-gray-100 bg-white p-6 text-center text-gray-700">
						<p>
							No upcoming events right now. Check back soon or{' '}
							<a href="/contact" class="font-medium text-tuhura-green hover:underline">
								contact us
							</a>{' '}
							about hosting one.
						</p>
						<div class="mt-4 flex justify-center">
							<a href="/contact" class="btn btn-secondary">
								Get Event Updates
							</a>
						</div>
					</div>
				) : (
					<div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
						{upcomingList.map((item) => (
							<Card variant="hover" padding="lg">
								<div class="mb-6 flex items-start">
									{item.logo ? (
										<div class="mr-6 flex h-14 w-14 items-center justify-center rounded-2xl border border-gray-100 bg-white p-2 shadow-sm md:h-16 md:w-16">
											<Image
												src={item.logo}
												alt={`${item.title} logo`}
												class="max-h-12 w-auto object-contain"
											/>
										</div>
									) : (
										<div class="mr-6 flex h-14 w-14 items-center justify-center rounded-2xl bg-tuhura-green shadow-sm md:h-16 md:w-16">
											<Icon name="heroicons:calendar-days" class="h-8 w-8 text-white" />
										</div>
									)}
									<div>
										<h3 class="text-xl font-bold text-gray-900">{item.title}</h3>
										{(item.date || item.location) && (
											<p class="mt-1 text-xs text-tuhura-green">
												{item.date}
												{item.date && item.location ? ' · ' : ''}
												{item.location}
											</p>
										)}
									</div>
								</div>
								<p class="mb-4 text-gray-700">{item.description}</p>
								<a
									href={item.link}
									target={isExternal(item.link) ? '_blank' : '_self'}
									rel={isExternal(item.link) ? 'noopener noreferrer' : undefined}
									class="font-medium text-tuhura-green hover:underline"
								>
									Learn more
								</a>
							</Card>
						))}
					</div>
				)
			}
		</div>
	</section>

	<!-- Event Types -->
	<section
		id="types"
		class="scroll-mt-24 bg-gradient-to-br from-tuhura-green/5 to-tuhura-blue/5 py-20"
	>
		<div class="container-custom">
			<div class="mx-auto mb-12 max-w-3xl text-center">
				<h2 class="mb-4 text-3xl font-bold md:text-4xl">Event Types</h2>
				<p class="text-lg leading-relaxed text-gray-600">
					The kinds of events we run with communities and partners.
				</p>
			</div>
			<div class="grid grid-cols-1 gap-8 md:grid-cols-2">
				{
					upcomingEvents.map((event) => (
						<Card variant="hover" padding="lg">
							<div class="mb-6 flex items-start">
								<div class="mr-6 flex h-16 w-16 flex-shrink-0 items-center justify-center rounded-2xl bg-tuhura-green shadow-lg">
									<Icon name={event.icon} class="h-8 w-8 text-white" />
								</div>
								<div>
									<h3 class="text-2xl font-bold text-gray-900">{event.title}</h3>
									<div class="mt-2 flex gap-4 text-xs text-tuhura-green">
										<span class="font-medium">
											<Icon name="heroicons:calendar" class="mr-1 inline h-4 w-4" />
											{event.frequency}
										</span>
										<span class="font-medium">
											<Icon name="heroicons:clock" class="mr-1 inline h-4 w-4" />
											{event.duration}
										</span>
									</div>
								</div>
							</div>
							<p class="text-base leading-relaxed text-gray-700">{event.description}</p>
						</Card>
					))
				}
			</div>
		</div>
	</section>

	<!-- Partnership Collaborations -->
	<section id="partners" class="scroll-mt-24 bg-white py-20">
		<div class="container-custom">
			<div class="mx-auto mb-12 max-w-3xl text-center">
				<h2 class="mb-4 text-3xl font-bold md:text-4xl">Community Partnership Events</h2>
				<p class="text-lg leading-relaxed text-gray-600">
					Delivered with national and community partners.
				</p>
			</div>
			<div class="grid grid-cols-1 gap-8 lg:grid-cols-2">
				{
					collabs.map((collab) => (
						<Card variant="hover" padding="lg">
							<div class="mb-6 flex items-start">
								{collab.logo ? (
									<div class="mr-6 flex h-14 w-14 items-center justify-center rounded-2xl border border-gray-100 bg-white p-2 shadow-sm md:h-16 md:w-16">
										<Image
											src={collab.logo}
											alt={`${collab.partnerName} logo`}
											class="max-h-12 w-auto object-contain"
										/>
									</div>
								) : (
									<div class="mr-6 flex h-14 w-14 items-center justify-center rounded-2xl bg-tuhura-green shadow-sm md:h-16 md:w-16">
										<Icon name="heroicons:building-office" class="h-8 w-8 text-white" />
									</div>
								)}
								<div>
									<h3 class="text-xl font-bold text-gray-900">{collab.eventName}</h3>
									<p class="text-sm font-medium text-tuhura-green">Partner: {collab.partnerName}</p>
								</div>
							</div>
							<p class="text-gray-700">{collab.description}</p>
						</Card>
					))
				}
			</div>
		</div>
	</section>
</Layout>

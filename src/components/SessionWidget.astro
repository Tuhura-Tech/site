---
import "leaflet/dist/leaflet.css";
---

<section class="pt-10 pb-8 md:pt-14 md:pb-12 overflow-hidden relative">
    <div class="container-custom relative">
        <div class="relative bg-white rounded-xl shadow-xl overflow-hidden">
            <div class="map-center-container">
                <div id="map"></div>
            </div>
        </div>
    </div>
</section>

<script>
    import { Map, TileLayer, Marker, Popup, FeatureGroup } from "leaflet";
    const sessions = [
        {
            name: "Wellington High School",
            address: "249 Taranaki Street, Mt Cook, 6011, Wellington",
            latlong: [-41.300334, 174.775107],
            age: "Year 9 - 13",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Monday at 3:30 - 5:30pm",
        },
        {
            name: "Strathmore Park Community Centre",
            address: "108 Strathmore Ave, Strathmore Park, Wellington 6022",
            latlong: [-41.330524, 174.821945],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Tuesday at 3:30 - 5:30pm",
        },
        {
            name: "Te Whare Pukapuka o Korimako, Ngaio - Cummings Park (Ngaio) Library",
            address: "1a Ottawa Road Ngaio Wellington",
            latlong: [-41.249884, 174.773312],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Tuesday at 3:30 - 5:30pm",
        },
        {
            name: "Te Mako Naenae Community Centre",
            address: "27 Hillary Court Naenae Lower Hutt 5011",
            latlong: [-41.198645, 174.947569],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Monday at 3:30 - 5:30pm",
        },
        {
            name: "Mana College",
            address: " Awarua St, Elsdon, Porirua 5022",
            latlong: [-41.1292217, 174.8329403],
            age: "Year 9 - 13",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Thursday at 3:30 - 5:30pm",
        },
        {
            name: "Walter Nash Neighbourhood Hub",
            address: "22/26 Taine Street, Taitā, Lower Hutt",
            latlong: [-41.198645, 174.947569],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Thursday at 3:30 - 5:30pm",
        },
        {
            name: "South Wellington Intermediate School",
            address: "30 Te Wharepōuri St, Newtown, Wellington 6021",
            latlong: [-41.318344, 174.778997],
            age: "Year 7 - 8",
            signupLink: null,
            time: "Friday at 1:00 - 3:00pm",
        },
        {
            name: "Johnsonville Library",
            address: "34 Moorefield Rd, Johnsonville, Wellington 6037",
            latlong: [-41.222825, 174.804714],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Monday at 3:30 - 5:30pm",
        },
        {
            name: "Te Whare Pukapuka o Te Māhanga - Karori Library",
            address: "247 Karori Rd, Karori, Wellington 6012",
            latlong: [-41.284831, 174.73754],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Monday at 3:30 - 5:30pm",
        },
        {
            name: "War Memorial Library",
            address: "2 Queens Drive, Lower Hutt 5010",
            latlong: [-41.211709, 174.900509],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Wednesday at 3:30 - 5:30pm",
        },
        {
            name: "Wainuiomata Community Library",
            address: "1 Queen St, Wainuiomata, Lower Hutt",
            latlong: [-41.261747, 174.944866],
            age: "Year 4 - 8",
            signupLink: "https://forms.gle/hJiRmvQF6QcjmJjt9",
            time: "Monday at 3:30 - 5:30pm",
        },
    ];

    const map = new Map("map");

    let markers = [];
    sessions.forEach((session) => {
        const marker = new Marker(session.latlong).addTo(map);
        if (session.signupLink !== null) {
            var popup = new Popup().setContent(
                `<div role="dialog"><div>${session.name}</div><br /><div>${session.time}</div><br /><a href="${session.signupLink}">Join Session</a></div>`,
            );
        } else {
            var popup = new Popup().setContent(
                `<div role="dialog"><div>${session.name}</div><br /><div>${session.time}</div><br /></div>`,
            );
        }

        marker.bindPopup(popup).openPopup();
        markers.push(marker);
    });

    var group = new FeatureGroup(markers);

    map.fitBounds(group.getBounds().pad(0.5));

    const tiles = new TileLayer(
        "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
        {
            maxZoom: 19,
            attribution:
                '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        },
    ).addTo(map);
</script>

<style>
    .map-center-container {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
    }

    #map {
        width: 100%;
        height: 100$;
        min-width: 320px;
        min-height: 320px;
        aspect-ratio: 1 / 1;
    }
</style>
